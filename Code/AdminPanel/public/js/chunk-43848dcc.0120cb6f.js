(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43848dcc"],{"335f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-icon",{attrs:{color:"primary"}},[t._v(" mdi-comment-alert ")]),a("span",{staticClass:"pl-2"},[t._v("Complaints")])],1),a("v-tabs",{staticClass:"my-2",attrs:{"show-arrows":""},model:{value:t.active_tab,callback:function(e){t.active_tab=e},expression:"active_tab"}},t._l(t.tabs,(function(e){return a("v-tab",{key:e.idx},[a("v-icon",{staticClass:"me-3",attrs:{size:"20"}},[t._v(" "+t._s(e.icon)+" ")]),a("span",[t._v(t._s(e.title))])],1)})),1),a("v-tabs-items",{model:{value:t.active_tab,callback:function(e){t.active_tab=e},expression:"active_tab"}},[a("v-tab-item",[a("complaints-table",{attrs:{complaints:t.activeComplaints,"is-loading":t.isLoading,"is-active":!0},on:{"view-complaint":t.viewComplaint,"refund-complaint":t.refundComplaint,"cancel-complaint":t.cancelComplaint}})],1),a("v-tab-item",[a("complaints-table",{attrs:{complaints:t.completedComplaints,"is-loading":t.isLoading,"is-active":!1},on:{"view-complaint":t.viewComplaint,"refund-complaint":t.refundComplaint,"cancel-complaint":t.cancelComplaint,"view-response":t.viewResponse}})],1)],1)],1)],1)},i=[],o=(a("e25e"),a("a434"),a("94ed")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-data-table",{attrs:{"item-key":"id",loading:t.isLoading,"loading-text":"Loading... Please wait",headers:t.isActive?t.activeHeaders:t.completedHeaders,items:t.complaints,search:t.search},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-text-field",{staticClass:"mx-4",attrs:{label:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]},proxy:!0},{key:"item.created_at",fn:function(e){var n=e.item;return[a("small",[t._v(t._s(t._f("moment")(n.created_at,"LL")))]),t._v(" - "),a("small",{staticClass:"text-muted"},[t._v(t._s(t._f("moment")(n.created_at,"LT")))])]}},{key:"item.planned_time",fn:function(e){var n=e.item;return[a("small",[t._v(t._s(t._f("moment")(n.planned_time,"LL")))]),t._v(" - "),a("small",{staticClass:"text-muted"},[t._v(t._s(t._f("moment")(n.planned_time,"LT")))])]}},{key:"item.actual_time",fn:function(e){var n=e.item;return[a("small",[t._v(t._s(t._f("moment")(n.actual_time,"LL")))]),t._v(" - "),a("small",{staticClass:"text-muted"},[t._v(t._s(t._f("moment")(n.actual_time,"LT")))])]}},{key:"item.action",fn:function(e){var n=e.item;return[t.isActive?t._e():a("v-chip",{attrs:{color:t.getComplaintActionColor(n.action),dark:""}},[t._v(" "+t._s(t.getComplaintActionValue(n.action))+" "),a("v-icon",{staticClass:"ml-2"},[t._v(" "+t._s(t.getIconOfComplaintAction(n.action))+" ")])],1)]}},{key:"item.actions",fn:function(e){var n=e.item;return[a("v-btn",{attrs:{depressed:"",small:"",density:"compact"},on:{click:function(e){return t.$emit("view-complaint",n)}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-message-bulleted ")])],1),t.isActive?t._e():a("v-btn",{attrs:{depressed:"",small:"",color:"primary",density:"compact"},on:{click:function(e){return t.$emit("view-response",n)}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-email-sync-outline ")])],1),t.isActive?a("v-btn",{staticClass:"mr-2",attrs:{depressed:"",small:"",density:"compact",color:"success"},on:{click:function(e){t.$emit("refund-complaint",n,t.complaints.indexOf(n))}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-cash-refund ")])],1):t._e(),t.isActive?a("v-btn",{attrs:{depressed:"",small:"",density:"compact",color:"error"},on:{click:function(e){t.$emit("cancel-complaint",n,t.complaints.indexOf(n))}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-close-octagon-outline ")])],1):t._e()]}}])})},s=[],l={props:{complaints:Array,isLoading:Boolean,isActive:Boolean},data:function(){return{search:"",activeHeaders:[{text:"Ticket",value:"ticket_number",align:"start"},{text:"Customer",value:"user.name"},{text:"Stop",value:"stop_name"},{text:"Distance To Stop",value:"distanceToStop"},{text:"Distance To Bus",value:"distanceToBus"},{text:"Planned arrival",value:"planned_time"},{text:"Actual arrival",value:"actual_time"},{text:"Created",value:"created_at"},{text:"",value:"actions",sortable:!1}],completedHeaders:[{text:"Ticket",value:"ticket_number",align:"start"},{text:"Customer",value:"user.name"},{text:"Stop",value:"stop_name"},{text:"Distance To Stop",value:"distanceToStop"},{text:"Distance To Bus",value:"distanceToBus"},{text:"Planned arrival",value:"planned_time"},{text:"Actual arrival",value:"actual_time"},{text:"Created",value:"created_at"},{text:"Action",value:"action"},{text:"",value:"actions",sortable:!1}]}},methods:{getComplaintActionColor:function(t){switch(t){case"refund":return"success";case"cancel":return"error";default:return"primary"}},getComplaintActionValue:function(t){switch(t){case"refund":return"Refunded";case"cancel":return"Cancelled";default:return"Pending"}},getIconOfComplaintAction:function(t){switch(t){case"refund":return"mdi-cash-refund";case"cancel":return"mdi-close-octagon-outline";default:return"mdi-email-sync-outline"}}}},r=l,m=(a("9268"),a("2877")),u=a("6544"),d=a.n(u),p=a("8336"),v=a("cc20"),f=a("8fea"),_=a("132d"),h=a("8654"),C=Object(m["a"])(r,c,s,!1,null,null,null),b=C.exports;d()(C,{VBtn:p["a"],VChip:v["a"],VDataTable:f["a"],VIcon:_["a"],VTextField:h["a"]});var x=a("b012"),g={components:{complaintsTable:b},data:function(){return{isLoading:!1,activeComplaints:[],completedComplaints:[],tabs:[{idx:0,title:"Active",icon:o["O"]},{idx:1,title:"Completed",icon:o["a"]}],active_tab:null,icons:{mdiAccountCheck:o["a"],mdiPlayCircleOutline:o["O"]}}},watch:{active_tab:function(t,e){localStorage.tabIdxComplaints=t}},mounted:function(){this.active_tab=parseInt(localStorage.tabIdxComplaints),this.loadComplaints()},methods:{loadComplaints:function(){var t=this;this.isLoading=!0,this.activeComplaints=[],this.completedComplaints=[],axios.get("/complaints/all").then((function(e){t.activeComplaints=e.data.active,t.completedComplaints=e.data.completed}))["catch"]((function(e){t.$notify({title:"Error",text:"Error while retrieving complaints",type:"error"}),console.log(e),x["a"].checkError(e.response.data.message,t.$router,t.$swal)})).then((function(){t.isLoading=!1}))},viewComplaint:function(t){this.$swal({title:"Complaint",html:t.complaint,icon:"info",showCancelButton:!1,confirmButtonText:"Ok"})},viewResponse:function(t){this.$swal({title:"Response",html:t.response,icon:"info",showCancelButton:!1,confirmButtonText:"Ok"})},cancelComplaint:function(t,e){var a=this;this.$swal({input:"textarea",inputPlaceholder:"Why are you cancelling this complaint?",inputAttributes:{"aria-label":"Why are you cancelling this complaint?"},title:"Cancel Complaint",html:"Are you sure you want to cancel this complaint?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel it!"}).then((function(n){console.log(n),n.isConfirmed&&a.takeActionOnComplaintServer(t.id,n.value,e,"cancel")}))},refundComplaint:function(t,e){var a=this;this.$swal({input:"textarea",inputPlaceholder:"Why are you are approving this refund?",inputAttributes:{"aria-label":"Why are you are approving this refund?"},title:"Refund Complaint",html:"Are you sure you want to refund this complaint?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, refund it!"}).then((function(n){n.isConfirmed&&a.takeActionOnComplaintServer(t.id,n.value,e,"refund")}))},takeActionOnComplaintServer:function(t,e,a,n){var i=this;this.isLoading=!0,axios.post("/complaints/take-action",{complaint_id:t,response:e,action:n}).then((function(t){i.$notify({title:"Success",text:"Complaint "+n+"d",type:"success"});var o=i.activeComplaints[a];o.response=e,o.action=n,i.completedComplaints.unshift(o),i.activeComplaints.splice(a,1)}))["catch"]((function(t){i.$notify({title:"Error",text:"Error while "+n+"ing complaint",type:"error"}),i.$swal("Error",t.response.data.message,"error")})).then((function(){i.isLoading=!1}))}}},w=g,y=(a("b636"),a("b0af")),k=a("99d9"),A=a("71a3"),T=a("c671"),L=a("fe57"),$=a("aac8"),B=Object(m["a"])(w,n,i,!1,null,null,null);e["default"]=B.exports;d()(B,{VCard:y["a"],VCardTitle:k["c"],VIcon:_["a"],VTab:A["a"],VTabItem:T["a"],VTabs:L["a"],VTabsItems:$["a"]})},9268:function(t,e,a){"use strict";a("e8db")},b636:function(t,e,a){"use strict";a("f798")},e8db:function(t,e,a){},f798:function(t,e,a){}}]);
//# sourceMappingURL=chunk-43848dcc.0120cb6f.js.map
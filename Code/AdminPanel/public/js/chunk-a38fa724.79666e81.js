(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a38fa724"],{"3ffe":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-btn",{staticClass:"mr-2",attrs:{depressed:"",disabled:!t.activationStore.isActivated,color:"primary"},on:{click:t.create}},[t._v(" Create "),n("v-icon",{attrs:{right:"",dark:""}},[t._v(" mdi-plus-thick ")])],1)},a=[],i=n("2fa3"),r={name:"CreateButton",setup:function(){return{activationStore:i["a"]}},methods:{create:function(){this.$emit("create")}}},c=r,s=n("2877"),l=n("6544"),u=n.n(l),d=n("8336"),f=n("132d"),p=Object(s["a"])(c,o,a,!1,null,null,null);e["a"]=p.exports;u()(p,{VBtn:d["a"],VIcon:f["a"]})},"4b85":function(t,e,n){},"62ad":function(t,e,n){"use strict";var o=n("ade3"),a=n("5530"),i=(n("13d5"),n("d3b7"),n("a9e3"),n("b64b"),n("ac1f"),n("5319"),n("4ec9"),n("3ca3"),n("ddb0"),n("caad"),n("4160"),n("159b"),n("45fc"),n("2ca0"),n("4b85"),n("2b0e")),r=n("d9f7"),c=n("80d2"),s=["sm","md","lg","xl"],l=function(){return s.reduce((function(t,e){return t[e]={type:[Boolean,String,Number],default:!1},t}),{})}(),u=function(){return s.reduce((function(t,e){return t["offset"+Object(c["G"])(e)]={type:[String,Number],default:null},t}),{})}(),d=function(){return s.reduce((function(t,e){return t["order"+Object(c["G"])(e)]={type:[String,Number],default:null},t}),{})}(),f={col:Object.keys(l),offset:Object.keys(u),order:Object.keys(d)};function p(t,e,n){var o=t;if(null!=n&&!1!==n){if(e){var a=e.replace(t,"");o+="-".concat(a)}return"col"!==t||""!==n&&!0!==n?(o+="-".concat(n),o.toLowerCase()):o.toLowerCase()}}var m=new Map;e["a"]=i["default"].extend({name:"v-col",functional:!0,props:Object(a["a"])(Object(a["a"])(Object(a["a"])(Object(a["a"])({cols:{type:[Boolean,String,Number],default:!1}},l),{},{offset:{type:[String,Number],default:null}},u),{},{order:{type:[String,Number],default:null}},d),{},{alignSelf:{type:String,default:null,validator:function(t){return["auto","start","end","center","baseline","stretch"].includes(t)}},tag:{type:String,default:"div"}}),render:function(t,e){var n=e.props,a=e.data,i=e.children,c=(e.parent,"");for(var s in n)c+=String(n[s]);var l=m.get(c);return l||function(){var t,e;for(e in l=[],f)f[e].forEach((function(t){var o=n[t],a=p(e,t,o);a&&l.push(a)}));var a=l.some((function(t){return t.startsWith("col-")}));l.push((t={col:!a||!n.cols},Object(o["a"])(t,"col-".concat(n.cols),n.cols),Object(o["a"])(t,"offset-".concat(n.offset),n.offset),Object(o["a"])(t,"order-".concat(n.order),n.order),Object(o["a"])(t,"align-self-".concat(n.alignSelf),n.alignSelf),t)),m.set(c,l)}(),t(n.tag,Object(r["a"])(a,{class:l}),i)}})},a29e:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",[n("v-card-title",[n("v-icon",{attrs:{color:"primary"}},[t._v(" mdi-ticket-percent ")]),n("span",{staticClass:"pl-2"},[t._v("Coupons")]),n("v-spacer"),n("create-button",{on:{create:t.showCouponDialog}}),n("activation-tool-tip",{attrs:{model:"coupons"}})],1),n("v-data-table",{attrs:{"item-key":"id",loading:t.isLoading,"loading-text":"Loading... Please wait",headers:t.headers,items:t.coupons,search:t.search},scopedSlots:t._u([{key:"top",fn:function(){return[n("v-text-field",{staticClass:"mx-4",attrs:{label:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]},proxy:!0},{key:"item.driver",fn:function(e){var o=e.item;return[n("v-chip",{attrs:{color:t.getDriverAssignmentColor(o.driver),dark:""},on:{click:function(e){return t.assignDriver(o)}}},[t._v(" "+t._s(t.getDriver(o.driver))+" ")])]}},{key:"item.discount",fn:function(e){var n=e.item;return[t._v(" "+t._s(n.discount)+"% ")]}},{key:"item.limit",fn:function(e){var n=e.item;return[t._v(" "+t._s(0==n.limit?"Unlimited":n.limit)+" ")]}},{key:"item.max_amount",fn:function(e){var n=e.item;return[t._v(" "+t._s(0==n.max_amount?"Unlimited":n.max_amount)+" ")]}},{key:"item.expiration_date",fn:function(e){var o=e.item;return[n("small",[t._v(t._s(t._f("moment")(o.expiration_date,"LL")))])]}},{key:"item.created_at",fn:function(e){var o=e.item;return[n("small",[t._v(t._s(t._f("moment")(o.created_at,"LL")))]),t._v(" - "),n("small",{staticClass:"text-muted"},[t._v(t._s(t._f("moment")(o.created_at,"LT")))])]}},{key:"item.actions",fn:function(e){var o=e.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editCoupon(o)}}},[t._v(" mdi-pencil ")]),n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){t.deleteCoupon(o,t.coupons.indexOf(o))}}},[t._v(" mdi-delete ")]),n("v-icon",{attrs:{small:""},on:{click:function(e){return t.sendNotification(o)}}},[t._v(" mdi-bell ")])]}}])})],1),n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{persistent:"","max-width":"900px"},model:{value:t.couponDialog,callback:function(e){t.couponDialog=e},expression:"couponDialog"}},[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-h5"},[t._v("Coupon data")])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{rules:t.codeRules,label:"Code*",hint:"code of the coupon",required:""},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{rules:t.discountRules,label:"Discount (%)*",hint:"Discount of the coupon",required:""},model:{value:t.discount,callback:function(e){t.discount=e},expression:"discount"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{rules:t.limitRules,label:"Limit*",hint:"Limit of coupon usage per customer. 0 means unlimited",required:""},model:{value:t.limit,callback:function(e){t.limit=e},expression:"limit"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{rules:t.max_amountRules,label:"Max amount*",hint:"Max amount of saving of the coupon. 0 means unlimited",required:""},model:{value:t.max_amount,callback:function(e){t.max_amount=e},expression:"max_amount"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[n("v-text-field",t._g({attrs:{rules:t.expiration_dateRules,label:"Expiration date*",hint:"Expiration date of the coupon",readonly:""},model:{value:t.expiration_date,callback:function(e){t.expiration_date=e},expression:"expiration_date"}},o))]}}])},[n("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:t.expiration_date,callback:function(e){t.expiration_date=e},expression:"expiration_date"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.couponDialog=!1}}},[t._v(" Close ")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.createCoupon}},[t._v(" Save ")])],1)],1)],1)],1)],1)],1)},a=[],i=(n("ac1f"),n("00b4"),n("e323"),n("accc"),n("0d03"),n("a434"),n("99af"),n("ef2c")),r=n("3ffe"),c=n("b012"),s={components:{ActivationToolTip:i["a"],CreateButton:r["a"]},data:function(){return{coupons:[],isLoading:!1,search:"",couponDialog:!1,valid:!0,id:null,code:"",codeRules:[function(t){return!!t||"Code is required"},function(t){return t&&t.length<=15||"Code must be less than 15 characters"}],limit:"1",limitRules:[function(t){return/^[0-9]+$/.test(t)||"Limit is not valid"}],discount:"10",discountRules:[function(t){return/^[0-9]+$/.test(t)||"Discount is not valid"}],max_amount:"1",max_amountRules:[function(t){return/^[0-9]+$/.test(t)||"Max amount is not valid"}],expiration_date:"",expiration_dateRules:[function(t){return!!t||"Expiration date is required"}],headers:[{text:"ID",value:"id",align:"start",filterable:!1},{text:"Code",value:"code"},{text:"Discount",value:"discount"},{text:"Usage limit",value:"limit"},{text:"Max Saving",value:"max_amount"},{text:"Expiration",value:"expiration_date"},{text:"Created",value:"created_at"},{text:"Actions",value:"actions",sortable:!1}]}},mounted:function(){this.loadCoupones()},methods:{loadCoupones:function(){var t=this;this.isLoading=!0,this.coupons=[],axios.get("/coupons/all").then((function(e){t.coupons=e.data}))["catch"]((function(e){t.$notify({title:"Error",text:"Error while retrieving coupons",type:"error"}),console.log(e),c["a"].checkError(e.response.data.message,t.$router,t.$swal)})).then((function(){t.isLoading=!1}))},validate:function(){return this.$refs.form.validate()},createCoupon:function(){var t=this;this.validate()&&(this.isLoading=!0,this.couponDialog=!1,axios.post("/coupons/create-edit",{coupon:{id:this.id,code:this.code,discount:this.discount,limit:this.limit,max_amount:this.max_amount,expiration_date:this.expiration_date}}).then((function(e){t.loadCoupones(),t.$notify({title:"Success",text:t.id?"Coupon updated!":"Coupon created!",type:"success"}),t.$swal("Success","Coupon "+(t.id?"updated":"created")+" successfully","success")}))["catch"]((function(e){t.$notify({title:"Error",text:"Error while creating coupon",type:"error"}),console.log(e),t.$swal("Error",e.response.data.message,"error")})).then((function(){t.isLoading=!1})))},showCouponDialog:function(){this.code="",this.limit="1",this.max_amount="1",this.discount="10",this.expiration_date=(new Date).toISOString().substr(0,10),this.id=null,this.couponDialog=!0},editCoupon:function(t){this.id=t.id,this.code=t.code,this.discount=t.discount,this.limit=t.limit,this.max_amount=t.max_amount,this.expiration_date=t.expiration_date,this.couponDialog=!0},deleteCoupon:function(t,e){var n=this;this.$swal.fire({title:"Delete coupon",text:"Are you sure to delete the coupon ' "+t.code+" ' ? You won't be able to revert this!",icon:"error",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then((function(o){o.isConfirmed&&n.deleteCouponServer(t.id,e)}))},deleteCouponServer:function(t,e){var n=this;axios["delete"]("/coupons/".concat(t)).then((function(t){n.coupons.splice(e,1),n.$notify({title:"Success",text:"Coupon deleted!",type:"success"})}))["catch"]((function(t){n.$notify({title:"Error",text:"Error while deleting coupons",type:"error"}),n.$swal("Error",t.response.data.message,"error")})).then((function(){}))},sendNotification:function(t){var e=this,n=new Date(t.expiration_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o="Use coupon code ".concat(t.code," and get a ").concat(t.discount,"% discount on your next trip. Coupon expires on ").concat(n,".");t.limit>0&&(o+=" Hurry up! The coupon is limited to ".concat(t.limit," uses.")),this.$swal({input:"textarea",inputPlaceholder:"Please enter the notification message here",inputAttributes:{"aria-label":"Please enter the notification message"},title:"Send notification about coupon to all customers",html:"Please enter the notification message",icon:"info",showCancelButton:!0,confirmButtonText:"Send notification",inputValue:o}).then((function(n){n.isConfirmed&&axios.post("/coupons/notify",{id:t.id,message:n.value}).then((function(t){e.$notify({title:"Success",text:"Notification sent successfully",type:"success"}),201==t.status&&e.$swal("Info",t.data.message,"info")}))["catch"]((function(t){e.$notify({title:"Error",text:"Error while sending notification",type:"error"}),console.log(t),e.$swal("Error",t.response.data.message,"error")}))}))}}},l=s,u=n("2877"),d=n("6544"),f=n.n(d),p=n("8336"),m=n("b0af"),v=n("99d9"),h=n("cc20"),x=n("62ad"),g=n("a523"),b=n("8fea"),_=n("2e4b"),y=n("169a"),C=n("4bd4"),k=n("132d"),S=n("e449"),w=n("0fd9"),D=n("2fa4"),$=n("8654"),j=Object(u["a"])(l,o,a,!1,null,null,null);e["default"]=j.exports;f()(j,{VBtn:p["a"],VCard:m["a"],VCardActions:v["a"],VCardText:v["b"],VCardTitle:v["c"],VChip:h["a"],VCol:x["a"],VContainer:g["a"],VDataTable:b["a"],VDatePicker:_["a"],VDialog:y["a"],VForm:C["a"],VIcon:k["a"],VMenu:S["a"],VRow:w["a"],VSpacer:D["a"],VTextField:$["a"]})},a523:function(t,e,n){"use strict";n("4de4"),n("d3b7"),n("b64b"),n("2ca0"),n("99af"),n("20f6"),n("4b85"),n("498a"),n("a15b");var o=n("2b0e");function a(t){return o["default"].extend({name:"v-".concat(t),functional:!0,props:{id:String,tag:{type:String,default:"div"}},render:function(e,n){var o=n.props,a=n.data,i=n.children;a.staticClass="".concat(t," ").concat(a.staticClass||"").trim();var r=a.attrs;if(r){a.attrs={};var c=Object.keys(r).filter((function(t){if("slot"===t)return!1;var e=r[t];return t.startsWith("data-")?(a.attrs[t]=e,!1):e||"string"===typeof e}));c.length&&(a.staticClass+=" ".concat(c.join(" ")))}return o.id&&(a.domProps=a.domProps||{},a.domProps.id=o.id),e(o.tag,a,i)}})}var i=n("d9f7");e["a"]=a("container").extend({name:"v-container",functional:!0,props:{id:String,tag:{type:String,default:"div"},fluid:{type:Boolean,default:!1}},render:function(t,e){var n,o=e.props,a=e.data,r=e.children,c=a.attrs;return c&&(a.attrs={},n=Object.keys(c).filter((function(t){if("slot"===t)return!1;var e=c[t];return t.startsWith("data-")?(a.attrs[t]=e,!1):e||"string"===typeof e}))),o.id&&(a.domProps=a.domProps||{},a.domProps.id=o.id),t(o.tag,Object(i["a"])(a,{staticClass:"container",class:Array({"container--fluid":o.fluid}).concat(n||[])}),r)}})},ef2c:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.activationStore.isActivated?t._e():n("v-tooltip",{attrs:{bottom:"",color:"primary"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[n("v-icon",t._g({attrs:{color:"primary"}},o),[t._v(" mdi-information-outline ")])]}}],null,!1,1816130901)},[n("span",[t._v("Activate the system to create "+t._s(t.model))])])},a=[],i=n("2fa3"),r={name:"ActivationToolTip",props:{model:{type:String,default:""}},setup:function(){return{activationStore:i["a"]}}},c=r,s=n("2877"),l=n("6544"),u=n.n(l),d=n("132d"),f=n("3a2f"),p=Object(s["a"])(c,o,a,!1,null,null,null);e["a"]=p.exports;u()(p,{VIcon:d["a"],VTooltip:f["a"]})}}]);
//# sourceMappingURL=chunk-a38fa724.79666e81.js.map